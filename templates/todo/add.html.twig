{% extends 'base.html.twig' %}

{% block title %}
	{{ pageTitle }}
{% endblock %}

{% block body %}
	<header class="text-center py-8">
		<h1 class="text-3xl font-semibold">{{ pageTitle ?? '' }}</h1>
		<p class="text-base text-emerald-600">
			{{ pageSubtitle ?? '' }}
		</p>
	</header>
    <div class="w-full py-6 px-2 bg-white shadow-md rounded-md">
        {{ form_start(todoForm) }}
            {{ form_row(todoForm.name) }}
            {{ form_row(todoForm.is_public) }}
            {{ form_row(todoForm.category) }}

            <div id="tasks" data-prototype="{{ form_widget(todoForm.tasks.vars.prototype)|e('html_attr') }}">
                {% for task in todoForm.tasks %}
                    <div class="task-item">
                        {{ form_row(task) }}
                    </div>
                {% endfor %}
            </div>

            <button type="button" class="add-task" data-target="#tasks">Ajouter une t√¢che</button>
            {{ form_row(todoForm.submit) }}
        {{ form_end(todoForm) }}
    </div>
<script>
document.querySelector('.add-task').addEventListener('click', function() {
    const collection = document.querySelector(this.dataset.target);
    const prototype = collection.dataset.prototype;
    const index = collection.children.length;
    const newForm = prototype.replace(/__name__/g, index);
    collection.insertAdjacentHTML('beforeend', newForm);
});
</script>
{% endblock %}
